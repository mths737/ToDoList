{% extends "index.html" %}
{% load static %}
{% block head %}
<script src="{% static 'js/task_list.js' %}"></script>
<link href="{% static 'css/task_list.css' %}" rel="stylesheet">
{% endblock head %}

{% block 'title' %}Lista de tarefas{% endblock 'title' %}

{% block 'content' %}
<div class="d-flex justify-content-center align-items-center" style="height:10%;width:100%;padding:0px;">
    <div class="d-flex justify-content-center align-items-center" style="height:100%;">
        <button id="button-menu" class="rounded-4" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
            <span id="span1"></span>
            <span id="span0"></span>
            <span id="span2"></span>
            <span id="span0"></span>
            <span id="span3"></span>
        </button>
    </div>
    <h2 class="container d-flex justify-content-center align-items-center rounded-4" style="width:100%;height:90%;border:solid black;box-shadow: inset 0px 0px 10px black;margin:0px">{% block 'h2' %}Lista de tarefas{% endblock 'h2' %}</h2>
</div>

<div class="rounded-3 scroll" style="height:80%;background-color:white;">
    <ul class="list-group">
        {% for task in tasks %}
                <li id="{{task.id}}" class="item list-group-item" onclick="selecionado({{task.id}}, {% block 'tela' %}'tasksList'{% endblock 'tela' %})" aria-current="true">
                    <div class="d-flex w-100 justify-content-between">
                      <p class="mb-1" style="font-weight: bold;">{{ task.title }}</p>
                      <small>{{ task.created_at }}</small>
                    </div>
                    <small>{% block 'completed' %}Incompleto{% endblock 'completed' %}</small>
                </li>
        {% endfor %}
    </ul>
</div>

<div class="container  d-flex justify-content-center align-items-center" style="height:10%;">
    <div class="container d-flex justify-content-center align-items-center" style="position:absolute;">
        {% block 'selected-form' %}
        <form action="{% url 'tasks_list' %}" id="acao-task" method="POST" class="container d-flex justify-content-center align-items-center" style="height:100%;width: 100%;">
            {% csrf_token %}
            <input name="selecionado" type="hidden" value="" id="selecionado">
            <div class="container d-flex justify-content-center align-items-center" style="height:100%;width: 50%;">
                <input name="botao" type='submit' value="concluido" id="concluido" class="btn btn-success" style="height:80%;width: 80%;margin 10px;display:none;box-shadow: inset 0px 0px 10px black;">
            </div>
            <div class="container d-flex justify-content-center align-items-center" style="height:100%;width: 50%;">
                <input name="botao" type='submit' value="excluir" id="excluir" class="btn btn-danger" style="height:80%;width: 80%;margin 10px;display:none;box-shadow: inset 0px 0px 10px black;">
            </div>
        </form>
        {% endblock 'selected-form' %}
    </div>

    <div class="container d-flex justify-content-center align-items-center">
        {% block 'novo' %}
        <input value="Novo" id="novo" type="submit" class="btn btn-secondary" 
        style="height:100%;width: 60%;margin 10px;box-shadow: inset 0px 0px 10px black;" 
        data-bs-toggle="modal" data-bs-target="#exampleModal">
        {% endblock 'novo' %}
    </div>

    {% block 'modal' %}
    <div class="modal fade" style="backdrop-filter: blur( 3px );" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="top:25%">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Adicionar uma tarefa</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="{% url 'add_task' %}" method="POST" class="container">
                    {% csrf_token %}
                    <input placeholder="Descrição" class="form-control" type="text" id="task_title" name="title" required>
                    <div class="modal-footer justify-content-center">
                        <input style="height:80%;width: 50%;margin 10px;box-shadow: inset 0px 0px 10px black;" type="submit" value="Adicionar" class="btn btn-secondary">
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endblock 'modal' %}
</div>

{% if msg %}
<div id="alert" class="justify-content-center align-items-center" style="position:absolute;height:100%;width:100%;backdrop-filter:blur(3px);top:0px; left:0px;display:flex;transition:0.5s">
    <div id="alert-box" class="alert alert-secondary d-block justify-content-center align-items-center" role="alert">
        <br>
        <br>
        <h2 class="text-center">{{ msg }}</h2>
        <div class="text-center">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
</div>
{% endif %}

<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel" style="background-color:lightgray;">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasExampleLabel">Menu</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <nav id='menu'>
        <ul id="menu-content">
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="{% url 'tasks_list' %}" class="link-menu">Lista de Tarefas</a></li>
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="{% url 'tasks_completed' %}" class="link-menu">Tarefas Concluídas</a></li>
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="" class="link-menu">Perfil do Usuário</a></li>
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="" class="link-menu">Configurações</a></li>
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="" class="link-menu">Ajuda</a></li>
            <li class="item-menu list-group-item d-flex align-items-center" aria-current="true"><a href="" class="link-menu">Logout</a></li>
        </ul>
    </nav>
  </div>

{% endblock 'content' %}